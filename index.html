<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grow a Garden - Choose Your Pets!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;700&display-swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #F0FDF4; /* Light Green */
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23A3E635' fill-opacity='0.2'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        .pet-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent; /* Removes tap highlight on mobile */
        }

        .pet-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }

        .pet-card.selected {
            transform: translateY(-5px) scale(1.02);
            border-color: #84CC16; /* Lime 500 */
            box-shadow: 0 0 30px #84CC16;
        }
        
        .pet-card.disabled:not(.selected) {
            cursor: not-allowed;
            opacity: 0.6;
            filter: grayscale(80%);
        }

        .rarity-badge {
            font-size: 0.75rem;
            padding: 2px 8px;
            border-radius: 9999px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .rarity-Common { background-color: #D1D5DB; color: #374151; }
        .rarity-Uncommon { background-color: #6EE7B7; color: #047857; }
        .rarity-Rare { background-color: #60A5FA; color: #1E40AF; }
        .rarity-Legendary { background-color: #FBBF24; color: #92400E; }
        .rarity-Mythic { background-color: #E879F9; color: #86198F; }
        
        .fade-in { animation: fadeIn 0.8s ease-in-out forwards; }
        .fade-out { animation: fadeOut 0.8s ease-in-out forwards; }
        
        .loading-text {
             opacity: 0;
             animation: fadeIn 1s ease-in-out forwards;
        }
        
        /* -- Sticky Header System -- */
        #sticky-header-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 50;
            background-color: transparent;
            box-shadow: none;
            transform: translateY(-100%);
            transition: transform 0.4s ease-in-out;
            visibility: hidden;
            pointer-events: none;
        }
        
        body.header-is-sticky #sticky-header-container {
            transform: translateY(0);
            visibility: visible;
        }

        body.header-is-sticky #sticky-header-container #pet-counter {
            filter: drop-shadow(0 8px 12px rgba(0, 0, 0, 0.25));
            transition: filter 0.3s ease-in-out;
        }

        body.header-is-sticky #header-content {
            visibility: hidden;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-20px); visibility: hidden; }
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- This header becomes sticky -->
    <div id="sticky-header-container" class="py-4">
        <!-- The counter will be cloned here by JS -->
    </div>

    <main class="w-full max-w-7xl mx-auto p-4 md:p-8">
        <!-- Page 1: Pet Selection -->
        <section id="pet-selection-page">
            <div id="header-content" class="text-center">
                <img src="https://static.wikia.nocookie.net/growagarden/images/3/39/Site-community-image/revision/latest?cb=20250514081717" alt="Grow a Garden Title" class="mx-auto mb-4 w-full max-w-lg drop-shadow-2xl">
                <div id="counter-container" class="py-4">
                    <div id="pet-counter" class="text-3xl font-bold bg-lime-600 text-white rounded-full w-28 h-28 flex items-center justify-center mx-auto shadow-xl border-4 border-white transition-all duration-150">
                        0/3
                    </div>
                </div>
            </div>
            
            <div id="header-sentinel" style="height: 1px;"></div>

            <div id="pet-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-6">
                <!-- Pets will be dynamically inserted here by JavaScript -->
            </div>
        </section>
    </main>

    <!-- Page 2: Nickname Input -->
    <section id="nickname-page" class="hidden fixed inset-0 flex flex-col items-center justify-center p-4 bg-f0fdf4/90 backdrop-blur-sm">
        <div class="text-center">
            <h1 class="text-4xl md:text-6xl font-bold text-yellow-900 drop-shadow-lg">Enter Your Nickname</h1>
            <p class="text-green-700 text-lg md:text-xl mt-2 mb-8">What is your in-game name?</p>
            <form id="nickname-form" class="flex flex-col items-center gap-4">
                <input type="text" id="nickname-input" placeholder="RobloxNickname" class="text-center text-xl p-4 rounded-full border-4 border-lime-500 shadow-lg w-full max-w-sm focus:outline-none focus:ring-4 focus:ring-lime-300" required>
                <button type="submit" class="bg-lime-600 text-white font-bold text-2xl py-4 px-10 rounded-full shadow-xl hover:bg-lime-700 transition-transform hover:scale-105">Submit</button>
            </form>
        </div>
    </section>

    <!-- Page 3: Loading / Success -->
    <section id="loading-page" class="hidden fixed inset-0 flex flex-col items-center justify-center bg-f0fdf4/90 backdrop-blur-sm">
        <div id="loading-spinner" class="w-24 h-24 border-8 border-dashed rounded-full animate-spin border-lime-600 mb-8"></div>
        <p id="loading-message" class="text-2xl md:text-4xl text-green-800 font-semibold text-center px-4"></p>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            const petGrid = document.getElementById('pet-grid');
            const petCounter = document.getElementById('pet-counter');
            const counterContainer = document.getElementById('counter-container');
            const headerSentinel = document.getElementById('header-sentinel');
            const stickyHeaderContainer = document.getElementById('sticky-header-container');
            
            const petSelectionPage = document.getElementById('pet-selection-page');
            const nicknamePage = document.getElementById('nickname-page');
            const loadingPage = document.getElementById('loading-page');
            const nicknameForm = document.getElementById('nickname-form');
            const nicknameInput = document.getElementById('nickname-input');

            const MAX_PETS = 3;
            let selectedPets = [];
            let observer;

            const petsData = [
                // Common
                { name: 'Bee', rarity: 'Common', img: 'images/rbl-bee-roblox-other-items-6056.jpg' },
                { name: 'Bunny', rarity: 'Common', img: 'images/rbl-bunny-roblox-other-items-6053.jpg' },
                { name: 'Crab', rarity: 'Common', img: 'images/rbl-crab-roblox-other-items-6250.jpg' },
                { name: 'Golden Lab', rarity: 'Common', img: 'images/rbl-golden-lab-roblox-other-items-6055.jpg' },
                { name: 'Seagull', rarity: 'Common', img: 'images/rbl-seagull-roblox-other-items-6249.jpg' },
                { name: 'Starfish', rarity: 'Common', img: 'images/rbl-starfish-roblox-other-items-6248.jpg' },
                // Uncommon
                { name: 'Black Bunny', rarity: 'Uncommon', img: 'images/rbl-black-bunny-roblox-other-items-6057.jpg' },
                { name: 'Chicken', rarity: 'Uncommon', img: 'images/rbl-chicken-roblox-other-items-6058.jpg' },
                { name: 'Deer', rarity: 'Uncommon', img: 'images/rbl-deer-roblox-other-items-6059.jpg' },
                // Rare
                { name: 'Flamingo', rarity: 'Rare', img: 'images/rbl-flamingo-roblox-other-items-6251.jpg' },
                { name: 'Hedgehog', rarity: 'Rare', img: 'images/rbl-hedgehog-roblox-other-items-6077.jpg' },
                { name: 'Honey Bee', rarity: 'Rare', img: 'images/rbl-honey-bee-roblox-other-items-6064.jpg' },
                { name: 'Kiwi', rarity: 'Rare', img: 'images/rbl-kiwi-roblox-other-items-6078.jpg' },
                { name: 'Orangutan', rarity: 'Rare', img: 'images/rbl-oragutan-roblox-other-items-6252.jpg' },
                { name: 'Rooster', rarity: 'Rare', img: 'images/rbl-rooster-roblox-other-items-6062.jpg' },
                { name: 'Seal', rarity: 'Rare', img: 'images/rbl-seal-roblox-other-items-6253.jpg' },
                { name: 'Spotted Deer', rarity: 'Rare', img: 'images/rbl-spotted-deer-roblox-other-items-6063.jpg' },
                { name: 'Toucan', rarity: 'Rare', img: 'images/rbl-toucan-roblox-other-items-6255.jpg' },
                // Legendary
                { name: 'Bald Eagle', rarity: 'Legendary', img: 'images/rbl-bald-eagle-roblox-other-items-6390.jpg' },
                { name: 'Capybara', rarity: 'Legendary', img: 'images/rbl-capybara-roblox-other-items-6245.jpg' },
                { name: 'Frog', rarity: 'Legendary', img: 'images/rbl-frog-roblox-other-items-6080.jpg' },
                { name: 'Kitsune', rarity: 'Legendary', img: 'images/rbl-kitsune-roblox-other-items-476.jpg' },
                { name: 'Meerkat', rarity: 'Legendary', img: 'images/rbl-meerkat-roblox-other-items-6314.jpg' },
                { name: 'Mole', rarity: 'Legendary', img: 'images/rbl-mole-roblox-other-items-6081.jpg' },
                { name: 'Moon Cat', rarity: 'Legendary', img: 'images/rbl-moon-cat-roblox-other-items-6082.jpg' },
                { name: 'Panda', rarity: 'Legendary', img: 'images/rbl-panda-roblox-other-items-6079.jpg' },
                { name: 'Peacock', rarity: 'Legendary', img: 'images/rbl-peacock-roblox-other-items-6244.jpg' },
                { name: 'Petal Bee', rarity: 'Legendary', img: 'images/rbl-petal-bee-roblox-other-items-6068.jpg' },
                { name: 'Polar Bear', rarity: 'Legendary', img: 'images/rbl-polar-bear-roblox-other-items-4969.jpg' },
                { name: 'Pterodactyl', rarity: 'Legendary', img: 'images/rbl-pterodactyl-roblox-other-items-6386.jpg' },
                { name: 'Raptor', rarity: 'Legendary', img: 'images/rbl-raptor-roblox-other-items-6389.jpg' },
                { name: 'Sand Snake', rarity: 'Legendary', img: 'images/rbl-sand-snake-roblox-other-items-6304.jpg' },
                { name: 'Scarlet Macaw', rarity: 'Legendary', img: 'images/rbl-scarlet-macaw-roblox-other-items-6246.jpg' },
                { name: 'Sea Otter', rarity: 'Legendary', img: 'images/rbl-sea-otter-roblox-other-items-6066.jpg' },
                { name: 'Silver Monkey', rarity: 'Legendary', img: 'images/rbl-silver-monkey-roblox-other-items-6067.jpg' },
                { name: 'Stegosaurus', rarity: 'Legendary', img: 'images/rbl-stegosaurus-roblox-other-items-6387.jpg' },
                { name: 'Tanchozuru', rarity: 'Legendary', img: 'images/rbl-tanchozuru-roblox-other-items-486.jpg' },
                { name: 'Triceratops', rarity: 'Legendary', img: 'images/rbl-triceratops-roblox-other-items-6388.jpg' },
                // Mythic
                { name: 'Ankylosaurus', rarity: 'Mythic', img: 'images/rbl-ankylosaurus-roblox-other-items-6443.jpg' },
                { name: 'Axolotl', rarity: 'Mythic', img: 'images/rbl-axolotl-roblox-other-items-6305.jpg' },
                { name: 'Bear Bee', rarity: 'Mythic', img: 'images/rbl-bear-bee-roblox-other-items-6076.jpg' },
                { name: 'Blood Owl', rarity: 'Mythic', img: 'images/rbl-blood-owl-roblox-other-items-4960.jpg' },
                { name: 'Brontosaurus', rarity: 'Mythic', img: 'images/rbl-brontosaurus-roblox-other-items-6385.jpg' },
                { name: 'Butterfly', rarity: 'Mythic', img: 'images/rbl-butterfly-roblox-other-items-6118.jpg' },
                { name: 'Cacao Seed', rarity: 'Mythic', img: 'images/rbl-cacao-seed-roblox-other-items-4955.jpg' },
                { name: 'Caterpillar', rarity: 'Mythic', img: 'images/rbl-caterpillar-roblox-other-items-6070.jpg' },
                { name: 'Chicken Zombie', rarity: 'Mythic', img: 'images/rbl-chicken-zombie-roblox-other-items-4959.jpg' },
                { name: 'Dilophosaurus', rarity: 'Mythic', img: 'images/rbl-dilophosaurus-roblox-other-items-6442.jpg' },
                { name: 'Disco Bee', rarity: 'Mythic', img: 'images/rbl-disco-bee-roblox-other-items-6117.jpg' },
                { name: 'Dragonfly', rarity: 'Mythic', img: 'images/rbl-dragonfly-roblox-other-items-4949.jpg' },
                { name: 'Echo Frog', rarity: 'Mythic', img: 'images/rbl-echo-frog-roblox-other-items-4975.jpg' },
                { name: 'Fennec Fox', rarity: 'Mythic', img: 'images/rbl-fennec-fox-roblox-other-items-6307.jpg' },
                { name: 'Giant Ant', rarity: 'Mythic', img: 'images/rbl-giant-ant-roblox-other-items-6071.jpg' },
                { name: 'Hamster', rarity: 'Mythic', img: 'images/rbl-hamster-roblox-other-items-6308.jpg' },
                { name: 'Hyacinth Macaw', rarity: 'Mythic', img: 'images/rbl-hyacinth-macaw-roblox-other-items-6306.jpg' },
                { name: 'Kappa', rarity: 'Mythic', img: 'images/rbl-kappa-roblox-other-items-481.jpg' },
                { name: 'Mimic Octopus', rarity: 'Mythic', img: 'images/rbl-mimic-octopus-roblox-other-items-6247.jpg' },
                { name: 'Night Owl', rarity: 'Mythic', img: 'images/rbl-night-owl-roblox-other-items-5000.jpg' },
                { name: 'Praying Mantis', rarity: 'Mythic', img: 'images/rbl-praying-mantis-roblox-other-items-4956.png' },
                { name: 'Queen Bee', rarity: 'Mythic', img: 'images/rbl-queen-bee-roblox-other-items-6051.png' },
                { name: 'Raccoon', rarity: 'Mythic', img: 'images/rbl-raccoon-roblox-other-items-4948.jpg' },
                { name: 'Red Fox', rarity: 'Mythic', img: 'images/rbl-red-fox-roblox-other-items-4950.jpg' },
                { name: 'Red Giant Ant', rarity: 'Mythic', img: 'images/rbl-red-giant-ant-roblox-other-items-6073.jpg' },
                { name: 'Spinosaurus', rarity: 'Mythic', img: 'images/rbl-spinosaurus-roblox-other-items-6444.jpg' },
                { name: 'Squirrel', rarity: 'Mythic', img: 'images/rbl-squirrel-roblox-other-items-6075.jpg' },
                { name: 'T-Rex', rarity: 'Mythic', img: 'images/rbl-t-rex-roblox-other-items-6384.jpg' },
                { name: 'Turtle', rarity: 'Mythic', img: 'images/rbl-turtle-roblox-other-items-4958.jpg' },
            ];

            const initStickyHeader = () => {
                const stickyCounterClone = counterContainer.cloneNode(true);
                stickyCounterClone.id = 'sticky-counter-container';
                stickyHeaderContainer.appendChild(stickyCounterClone);
                
                const handler = (entries) => {
                    document.body.classList.toggle('header-is-sticky', !entries[0].isIntersecting);
                };

                observer = new IntersectionObserver(handler);
                observer.observe(headerSentinel);
            };

            const renderPets = () => {
                petGrid.innerHTML = '';
                petsData.forEach((pet, index) => {
                    const card = document.createElement('div');
                    card.className = 'pet-card bg-white rounded-2xl shadow-lg overflow-hidden border-4 border-transparent';
                    card.dataset.index = index;
                    card.innerHTML = `
                        <img src="${pet.img}" alt="${pet.name}" class="w-full h-auto object-cover aspect-square" onerror="this.onerror=null;this.src='https://placehold.co/200x200/F0FDF4/9CA3AF?text=Image+Missing';">
                        <div class="p-4 text-center">
                            <h3 class="font-bold text-lg text-yellow-900">${pet.name}</h3>
                            <span class="rarity-badge rarity-${pet.rarity}">${pet.rarity}</span>
                        </div>`;
                    card.addEventListener('click', () => handlePetClick(card, pet));
                    petGrid.appendChild(card);
                });
            };

            const handlePetClick = (cardElement, pet) => {
                if (selectedPets.length >= MAX_PETS) return;

                const isSelected = selectedPets.some(p => p.name === pet.name);

                if (isSelected) {
                    selectedPets = selectedPets.filter(p => p.name !== pet.name);
                    cardElement.classList.remove('selected');
                } else {
                    selectedPets.push(pet);
                    cardElement.classList.add('selected');
                }
                
                updateCounterAndState();
            };

            const updateCounterAndState = () => {
                const newCountText = `${selectedPets.length}/${MAX_PETS}`;
                document.querySelectorAll('#pet-counter').forEach(el => el.textContent = newCountText);
                
                petCounter.style.transform = 'scale(1.1)';
                setTimeout(() => petCounter.style.transform = 'scale(1)'), 150;

                const allCards = document.querySelectorAll('.pet-card');
                if (selectedPets.length >= MAX_PETS) {
                    allCards.forEach(card => card.classList.add('disabled'));
                    setTimeout(transitionToNickname, 1200);
                } else {
                    allCards.forEach(card => card.classList.remove('disabled'));
                }
            };

            const transitionToNickname = () => {
                if (observer) observer.disconnect();
                document.body.classList.remove('header-is-sticky');
                petSelectionPage.classList.add('fade-out');
                
                setTimeout(() => {
                    petSelectionPage.style.display = 'none';
                    nicknamePage.classList.remove('hidden');
                    nicknamePage.classList.add('fade-in');
                }, 800);
            };

            nicknameForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const nickname = nicknameInput.value;
                if (nickname) {
                    transitionToLoading(nickname);
                }
            });

            const transitionToLoading = (nickname) => {
                nicknamePage.classList.remove('fade-in');
                nicknamePage.classList.add('fade-out');
                setTimeout(() => {
                    nicknamePage.style.display = 'none';
                    loadingPage.classList.remove('hidden');
                    loadingPage.classList.add('fade-in');
                    runLoadingSequence(nickname);
                }, 800);
            };

            const runLoadingSequence = (nickname) => {
                const loadingMessage = document.getElementById('loading-message');
                const loadingSpinner = document.getElementById('loading-spinner');
                const messages = [
                    "Connecting to Roblox servers...",
                    `Verifying account: ${nickname}...`,
                    "Planting seeds for your new friends...",
                    "Adding pets to your garden...",
                ];
                let messageIndex = 0;
                
                const showNextMessage = () => {
                    if (messageIndex < messages.length) {
                        loadingMessage.textContent = messages[messageIndex++];
                        setTimeout(showNextMessage, 2000);
                    } else {
                       showSuccess(nickname);
                    }
                };
                
                const showSuccess = (finalNickname) => {
                    loadingSpinner.style.display = 'none';
                    loadingMessage.innerHTML = `
                        <div class="fade-in">
                            <svg class="w-24 h-24 text-green-500 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <h2 class="text-3xl md:text-5xl font-bold text-yellow-900">Success!</h2>
                            <p class="text-green-700 text-lg md:text-xl mt-2">Your new pets have been transferred to <span class="font-bold">${finalNickname}</span>!</p>
                        </div>`;
                };

                showNextMessage();
            };
            
            // --- APP INITIALIZATION ---
            initStickyHeader();
            renderPets();
        });
    </script>
</body>
</html>